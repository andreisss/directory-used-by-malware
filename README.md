# directory-used-by-malware

We have a string of directories under this category that is used by applications to store user-specific data. 
Some of these folders, like AppData and Roaming, are used by malware to copy themselves into these folders and execute them from these folders.

The following lists some of the folders where <user> is your user login account name.
  
•••My Documents C:\Users\<user>\Documents
  
•••Desktop C:\Users\<user>\Desktop
  
•••AppData C:\Users\<user>\AppData
  
•••Roaming C:\Users\<user>\AppData\Roaming

  
  Some of these paths like the AppData and Roaming are hidden by Windows and are
not visible unless you enable the option to show hidden files and folders as described in
the “Show Hidden Files and Folders”

  
  
From a malware analysis perspective, if you see a process
that has one of the names that match any of the OS system programs or more, verify the
path of the program to make sure it is located in the directory C:\Windows\system32. If
it is any other directory, most likely, the process is malicious, masquerading itself as a system process.

  
•••Process Image Path
This is the path of the program from which the process is created. By default, the binaries
of the system processes should be in C:\Windows\system32. Now we know that the
system32 folder contains OS system processes. While analyzing malware, if you find a
process that has the name of an OS system process, but with an image file path that is not
in the C:\Windows\system32 folder, you should treat it as suspicious and investigate it
further.
  
![image description](https://i.ibb.co/L8GPVcL/parent-rpcoess.png)
  
  
  Most of the system processes have only one instance executing at any point in time.
The only exception to this is csrss.exe, which has two instances running. Another
is svchost.exe, which can have multiple instances running. So svchost.exe is a soft
target for malware. A lot of malware names itself svchost.exe, with the idea that its
process gets lost among clean instances and thereby escapes detection by the user/
analyst.
  
•••Command-Line Tools to Register a Service
sc.exe create SNAME start= auto binpath= <path_to_service_exe> where, SNAME is the name of the new service
regsvr32.exe <path_to_service_dll>
